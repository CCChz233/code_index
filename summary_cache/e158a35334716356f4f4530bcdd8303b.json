{"summary": "- The script defines a CLI tool using Typer for analyzing OpenAI API usage data.\n- It reads the OpenAI API key from environment variables.\n- A dictionary `MODEL_COSTS` maps model names to per-token cost rates for prompts and completions.\n- The core function `group_and_sum_by_date_and_snapshot` takes a list of usage records (each a dict with keys like `snapshot_id`, `aggregation_timestamp`, `n_requests`, `n_generated_tokens_total`, `n_context_tokens_total`), aggregates them by date (converted from timestamps) and model snapshot, computes total requests, total tokens and total cost using `calculate_cost` (which presumably follows the `MODEL_COSTS` mapping). It then builds a Rich RichTable (Rich) to display the aggregated results.\n- The function returns a Rich Table.\nWe need to produce a summary of functionality, focusing on business logic, inputs, outputs. Use Chinese (maybe mix Chinese/English). Must start directly with summary content, no \"This code does...\". So start with something like \"\u8be5\u811a\u672c\u5b9e\u73b0\u4e86...\" etc. Provide details: CLI tool, reads env var, model cost mapping, function aggregates usage data, calculates cost, returns Rich Table. Also mention that calculate_cost is referenced but not defined here. Provide inputs: list of dict usage data. Output: Rich Table object. Also mention that Typer app defined but not used in snippet. Provide business logic: grouping by date and snapshot, summing requests, tokens, cost. Use Chinese. Let's craft.assistantfinal\u8be5\u811a\u672c\u5b9e\u73b0\u4e86\u4e00\u4e2a\u57fa\u4e8e **Typer** \u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u5bf9 OpenAI API \u7684\u4f7f\u7528\u60c5\u51b5\u8fdb\u884c\u7edf\u8ba1\u4e0e\u5c55\u793a\uff0c\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u5982\u4e0b\uff1a\n\n1. **\u73af\u5883\u914d\u7f6e**  \n   - \u4ece\u73af\u5883\u53d8\u91cf `OPENAI_API_KEY` \u8bfb\u53d6 OpenAI API Key\uff0c\u4f9b\u540e\u7eed\u8c03\u7528 OpenAI \u63a5\u53e3\uff08\u867d\u7136\u672c\u6bb5\u4ee3\u7801\u672a\u76f4\u63a5\u4f7f\u7528\uff0c\u4f46\u4e3a\u6574\u4e2a CLI \u63d0\u4f9b\u51ed\u8bc1\uff09\u3002\n\n2. **\u6a21\u578b\u8ba1\u8d39\u89c4\u5219**  \n   - `MODEL_COSTS` \u5b57\u5178\u6620\u5c04\u6bcf\u4e2a\u6a21\u578b\uff08\u5982 `gpt\u20114o`\u3001`gpt\u20113.5\u2011turbo`\u3001`text\u2011embedding\u20113\u2011small` \u7b49\uff09\u5230\u5176 **prompt** \u4e0e **completion** \u7684\u6bcf\u5343 token \u8d39\u7528\uff08\u5355\u4f4d\uff1a\u7f8e\u5143/\u5343 token\uff09\u3002  \n   - \u8ba1\u8d39\u89c4\u5219\u5728\u540e\u7eed\u7684 `calculate_cost`\uff08\u672c\u6587\u4ef6\u672a\u5b9e\u73b0\uff09\u4e2d\u88ab\u5f15\u7528\uff0c\u7528\u4e8e\u8ba1\u7b97\u5355\u6761", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:55:34.670753"}