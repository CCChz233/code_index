{"summary": "- The function `merge_consecutive_messages` takes a list of message dictionaries as input, where each dictionary contains a \"role\" and \"content\" key.\n- It merges consecutive messages with the same role (e.g., user or assistant) into a single message.\n- If the content of the messages is not a flat string (i.e., it is a JSON-like structure), it transforms the content into a list of text.\n- The function returns a new list of merged merged messages.\n- The function uses `logger` for logging.\nWe have to produce a summary of the functionality of the code. The code includes imports, definitions, and a function merge_consecutive_messages. The user gave a summary already. We need to produce a new summary, following the requirements: start directly with the summary content, no \"This code does...\" or \"Here is...\". Focus on business logic, inputs, outputs. Use Chinese (e.g., Chinese/English). So we need to produce a Chinese summary, maybe with some English terms. Provide concise description.\n\nThe code includes many imports, but the core function is merge_consecutive_messages. The summary should mention that it merges consecutive messages with same role, handling flat string vs structured content, returns new list. Also mention that logger is defined but not used inside function (maybe used elsewhere). Provide input type: list[dict[str, Any]]; output: list[dict[str, Any]].\n\nLet's produce Chinese summary. Ensure we start directly with summary content. No preamble. Let's do it.assistantfinal\u5408\u5e76\u8fde\u7eed\u540c\u89d2\u8272\u6d88\u606f\u7684\u5de5\u5177\u51fd\u6570  \n- **\u8f93\u5165**\uff1a`messages: list[dict[str, Any]]`\uff0c\u6bcf\u4e2a\u5b57\u5178\u5fc5\u987b\u5305\u542b `\"role\"`\uff08\u5982 `\"user\"`\u3001`\"assistant\"`\uff09\u548c `\"content\"`\uff08\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u6216\u7ed3\u6784\u5316\u5bf9\u8c61\uff09\u3002  \n- **\u4e1a\u52a1\u903b\u8f91**\uff1a  \n  1. \u68c0\u6d4b\u6240\u6709\u6d88\u606f\u7684 `content` \u662f\u5426\u7edf\u4e00\u4e3a\u7eaf\u5b57\u7b26\u4e32\uff08`flat_string`\uff09\u3002  \n  2. \u82e5\u51fa\u73b0\u975e\u5b57\u7b26\u4e32\u5185\u5bb9\uff0c\u5219\u628a\u5b57\u7b26\u4e32 `content` \u5305\u88c5\u4e3a `[{ \"type\": \"text\", \"text\": <string> }]`\uff0c\u7edf\u4e00\u4e3a\u5217\u8868\u5f62\u5f0f\u3002  \n  3. \u904d\u5386\u539f\u59cb\u5217\u8868\uff0c\u82e5\u5f53\u524d\u6d88\u606f\u7684 `role` \u4e0e\u524d\u4e00\u6761\u5408\u5e76\u540e\u6d88\u606f\u76f8\u540c\uff0c\u5219\uff1a  \n     - `flat_string` \u4e3a\u771f\u65f6\uff0c\u5c06\u5b57\u7b26\u4e32\u5185\u5bb9\u901a\u8fc7 `\"\\n\\n\"` \u8fde\u63a5\u8ffd\u52a0\u3002  \n     - `flat_string", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:40:03.067392"}