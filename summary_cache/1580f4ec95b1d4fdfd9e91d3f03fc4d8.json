{"summary": "We need to summarize the functionality of the code snippet. The code is from aiohttp/pytest_plugin.py. It defines a pytest fixture named aiohttp_server that yields a factory function to create a TestServer instance for a given aiohttp Application. It also ensures cleanup of servers after tests. It uses asyncio loop. It imports many modules. It defines a type variable _Request. The fixture returns an iterator yielding a coroutine function go that creates a TestServer, starts it, and appends to list. After test, finalizer closes all servers.\n\nWe need to output summary in Chinese (maybe with some English). Must start directly with summary content, no \"This code does...\". So start with something like \"\u63d0\u4f9b\u4e00\u4e2a pytest fixture `aiohttp_server`\uff0c\u7528\u4e8e\u5728\u6d4b\u8bd5\u4e2d\u521b\u5efa\u5e76\u7ba1\u7406 aiohttp \u7684 TestServer \u5b9e\u4f8b...\" etc.\n\nLet's produce final answer.assistantfinal\u63d0\u4f9b\u4e00\u4e2a `pytest` fixture **aiohttp_server**\uff0c\u7528\u4e8e\u5728\u6d4b\u8bd5\u671f\u95f4\u52a8\u6001\u521b\u5efa\u5e76\u7ba1\u7406 `aiohttp` \u7684 `TestServer` \u5b9e\u4f8b\u3002  \n\n- **\u8f93\u5165**\uff1a  \n  - `loop`\uff1a`asyncio.AbstractEventLoop`\uff08\u7531 pytest \u6ce8\u5165\uff09\u3002  \n  - \u8c03\u7528\u8fd4\u56de\u7684\u5de5\u5382\u51fd\u6570 `go(app, *, port=None, **kwargs)`\uff0c\u5176\u4e2d `app` \u4e3a `aiohttp.web.Application`\uff0c\u53ef\u9009 `port` \u6307\u5b9a\u76d1\u542c\u7aef\u53e3\uff0c`**kwargs` \u4f20\u9012\u7ed9 `TestServer.start_server`\u3002  \n\n- **\u4e1a\u52a1\u903b\u8f91**\uff1a  \n  1. \u5728 fixture \u521d\u59cb\u5316\u65f6\u521b\u5efa\u7a7a\u5217\u8868 `servers` \u7528\u4e8e\u8bb0\u5f55\u6240\u6709\u542f\u52a8\u7684\u670d\u52a1\u5668\u3002  \n  2. `go` \u4e3a\u5f02\u6b65\u51fd\u6570\uff1a  \n     - \u5b9e\u4f8b\u5316 `TestServer(app, port=port)`\u3002  \n     - \u8c03\u7528 `await server.start_server(**kwargs)` \u542f\u52a8\u670d\u52a1\u5668\u3002  \n     - \u5c06\u670d\u52a1\u5668\u5bf9\u8c61\u52a0\u5165 `servers` \u5217\u8868\u5e76\u8fd4\u56de\u3002  \n  3. `yield go` \u5c06\u5de5\u5382\u51fd\u6570\u63d0\u4f9b\u7ed9\u6d4b\u8bd5\u7528\u4f8b\u4f7f\u7528\u3002  \n  4. \u6d4b\u8bd5\u7ed3\u675f\u540e\uff0cfixture \u7684 teardown \u9636\u6bb5\u6267\u884c `finalize`\uff1a  \n     - \u5faa\u73af\u5f39\u51fa `servers` \u4e2d\u7684\u6bcf\u4e2a `TestServer`\uff0c\u5e76 `await server.close()` \u8fdb\u884c\u8d44\u6e90\u6e05\u7406\u3002  \n     - \u901a\u8fc7 `loop.run_until_complete(finalize())` \u540c\u6b65\u7b49\u5f85\u5168\u90e8\u5173\u95ed\u5b8c\u6210\u3002  \n\n- **\u8f93\u51fa**\uff1a  \n  - \u5728\u6d4b\u8bd5\u4ee3\u7801\u4e2d\u5f97\u5230\u4e00\u4e2a\u53ef\u8c03\u7528\u7684\u5f02\u6b65\u5de5\u5382 `", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:59:10.222763"}