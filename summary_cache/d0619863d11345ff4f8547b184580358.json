{"summary": "\u8be5\u51fd\u6570 `add_parent_mass` \u63a5\u6536\u4e00\u4e2a\u5149\u8c31\u5bf9\u8c61 `spectrum_in`\uff08\u7c7b\u578b\u4e3a `SpectrumType`\uff09\uff0c\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u7236\u8d28\u91cf\uff08parent_mass\uff09\u7684\u5149\u8c31\u5bf9\u8c61\u3002\u82e5\u8f93\u5165\u4e3a\u7a7a\u8fd4\u56de `None`\uff0c\u5426\u5219\u514b\u9686\u539f\u5149\u8c31\u3002\u82e5\u5143\u6570\u636e\u4e2d\u7f3a\u5c11 `parent_mass`\uff0c\u5219\u5c1d\u8bd5\u901a\u8fc7 `charge`\u3001`PROTON_MASS` \u5e38\u91cf\u3001\u4ee5\u53ca `pepmass`\uff08\u524d\u4f53\u79bb\u5b50 m/z\uff09\u8ba1\u7b97\u7236\u8d28\u91cf\uff1a`parent_mass = precursor_mz * |charge| - PROTON_MASS * charge`\u3002\u8ba1\u7b97\u6210\u529f\u540e\u5c06 `parent_mass` \u5199\u5165\u5149\u8c31\u5143\u6570\u636e\uff1b\u82e5\u7f3a\u5c11\u5fc5\u8981\u5b57\u6bb5\u5219\u6253\u5370\u63d0\u793a\u4fe1\u606f\u3002\u6700\u7ec8\u8fd4\u56de\u66f4\u65b0\u540e\u7684\u5149\u8c31\u5bf9\u8c61\u3002\nWe need to produce final answer: summary content directly, no intro. Use Chinese (maybe mix). Provide business logic, inputs, outputs. Let's craft final.assistantfinal\u8be5\u51fd\u6570 `add_parent_mass` \u63a5\u6536\u4e00\u4e2a\u5149\u8c31\u5bf9\u8c61 `spectrum_in`\uff08\u5b9e\u73b0 `SpectrumType` \u63a5\u53e3\uff09\uff0c\u8fd4\u56de\u540c\u7c7b\u578b\u7684\u5149\u8c31\u5bf9\u8c61\uff0c\u82e5\u8f93\u5165\u4e3a `None` \u5219\u76f4\u63a5\u8fd4\u56de `None`\u3002\n\n**\u4e1a\u52a1\u903b\u8f91**  \n1. \u5bf9\u8f93\u5165\u5149\u8c31\u8fdb\u884c\u514b\u9686\uff0c\u907f\u514d\u4fee\u6539\u539f\u59cb\u6570\u636e\u3002  \n2. \u68c0\u67e5\u514b\u9686\u540e\u5149\u8c31\u7684\u5143\u6570\u636e\u4e2d\u662f\u5426\u5df2\u6709 `parent_mass`\uff1a  \n   - \u82e5\u5df2\u5b58\u5728\uff0c\u76f4\u63a5\u8fd4\u56de\u514b\u9686\u5149\u8c31\u3002  \n   - \u82e5\u4e0d\u5b58\u5728\uff0c\u5c1d\u8bd5\u4f9d\u636e\u4ee5\u4e0b\u5b57\u6bb5\u8ba1\u7b97\u7236\u8d28\u91cf\uff1a  \n     - `charge`\uff08\u7535\u8377\u6570\uff09  \n     - `pepmass`\uff08\u524d\u4f53\u79bb\u5b50 m/z\uff0c\u53d6\u7b2c\u4e00\u4e2a\u503c\uff09  \n     - \u5e38\u91cf `PROTON_MASS`\uff08\u8d28\u5b50\u8d28\u91cf\uff09  \n   - \u8ba1\u7b97\u516c\u5f0f\uff1a  \n     ```\n     precursor_mass = pepmass[0] * |charge|\n     protons_mass   = PROTON_MASS * charge\n     parent_mass    = precursor_mass - protons_mass\n     ```\n   - \u82e5\u8ba1\u7b97\u6210\u529f\uff0c\u5c06 `parent_mass` \u5199\u5165\u5149\u8c31\u7684\u5143\u6570\u636e\u3002  \n   - \u82e5\u7f3a\u5c11 `charge` \u6216 `pepmass` \u7b49\u5173\u952e\u5b57\u6bb5\uff0c\u6355\u83b7 `KeyError` \u5e76\u6253\u5370\u63d0\u793a \u201cNot sufficient spectrum metadata to derive parent mass.\u201d\u3002\n\n**\u8f93\u5165**  \n- `spectrum_in: SpectrumType` \u2013 \u5305\u542b\u5143\u6570\u636e\uff08\u5982 `charge`\u3001`pepmass`\uff09\u7684\u5149\u8c31\u5bf9\u8c61\u3002\n\n**\u8f93\u51fa**  \n- `SpectrumType", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:42:10.926855"}