{"summary": "- \u8be5\u6d4b\u8bd5\u9a8c\u8bc1\u4e86 `combine_system_messages` \u51fd\u6570\u5728\u5c06\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684\u7cfb\u7edf\u6d88\u606f\u4e0e\u65b0\u6d88\u606f\u5217\u8868\u5408\u5e76\u65f6\u7684\u884c\u4e3a\u3002  \n- \u8f93\u5165\uff1a  \n  - `existing` \u4e3a\u5b57\u7b26\u4e32 `\"You are an AI assistant.\"`\u3002  \n  - `new` \u4e3a\u5305\u542b\u4e24\u4e2a\u5b57\u5178\u7684\u5217\u8868\uff0c\u5206\u522b\u8868\u793a\u5e26\u6709 `cache_control` \u7684\u6587\u672c\u6d88\u606f\u548c\u666e\u901a\u6587\u672c\u6d88\u606f\u3002  \n- \u8fc7\u7a0b\uff1a`combine_system_messages` \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5355\u6761\u6587\u672c\u6d88\u606f\u5bf9\u8c61\uff0c\u5e76\u5c06\u5176\u4e0e `new` \u5217\u8868\u987a\u5e8f\u62fc\u63a5\u3002  \n- \u8f93\u51fa\uff1a\u8fd4\u56de\u4e00\u4e2a\u5217\u8868\uff0c\u5305\u542b\u539f\u59cb\u5b57\u7b26\u4e32\u8f6c\u6362\u540e\u7684\u6d88\u606f\u5bf9\u8c61\u4ee5\u53ca `new` \u4e2d\u7684\u6240\u6709\u6d88\u606f\u5bf9\u8c61\uff0c\u987a\u5e8f\u4fdd\u6301\u4e0d\u53d8\u3002  \n- \u65ad\u8a00\u7ed3\u679c\u5217\u8868\u4e0e\u9884\u671f\u5217\u8868\u5b8c\u5168\u76f8\u540c\uff0c\u786e\u4fdd\u5408\u5e76\u903b\u8f91\u6b63\u786e\u3002\nThe user gave a prompt: \"You are a senior code analyst. Summarize the functionality of the following code. Requirements: 1. Start directly with the summary content. No \"This code does...\" or \"Here is...\". 2. Focus on the business logic, inputs, and outputs. 3. Use Chinese (e.g., Chinese/English).\"\n\nThey provided a code snippet: tests/test_utils.py import json import pytest from instructor.utils import ( classproperty, extract_json_from_codeblock, extract_json_from_stream, extract_json_from_stream_async, merge_consecutive_messages, extract_system_messages, combine_system_messages, ) def test_combine_system_messages_string_to_cache_control(): existing = \"You are an AI assistant.\" new = [ { \"type\": \"text\", \"text\": \"Analyze this text:\", \"cache_control\": {\"type\": \"ephemeral\"}, }, {\"type\": \"text\", \"text\": \"<long text content>\"}, ] result = combine_system_messages(existing, new) expected = [ {\"type\": \"text\", \"text\": \"You are an AI assistant.\"}, { \"type\": \"text\", \"text\": \"Analyze this text:\", \"cache_control\": {\"type\": \"ephemeral\"}, }, {\"type\": \"text\", \"text\": \"<long text content>\"}, ] assert result == expected\n\nThen they gave a summary already: \"Summary: - \u8be5\u6d4b\u8bd5\u9a8c\u8bc1\u4e86 `combine_system_messages` \u51fd\u6570\u5728\u5c06\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684\u7cfb\u7edf\u6d88\u606f\u4e0e\u65b0\u6d88\u606f\u5217\u8868\u5408\u5e76\u65f6\u7684\u884c\u4e3a\u3002 - \u8f93\u5165\uff1a - `existing` \u4e3a\u5b57\u7b26\u4e32 `\"You are an AI assistant.\"`\u3002 - `new` \u4e3a\u5305\u542b\u4e24\u4e2a\u5b57\u5178\u7684\u5217\u8868", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:52:41.701631"}