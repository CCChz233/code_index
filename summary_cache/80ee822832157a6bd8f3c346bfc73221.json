{"summary": "- The script generates C header search code and Python module for HTTP headers.\n- It reads the original source (from `calc_headers`), uses `io` and `pathlib.\nWe need to summarize functionality of the code. Let's read the code snippet. It seems truncated. The code includes imports, defines ROOT, headers = calc_headers(ROOT), TERMINAL = object(), dct = build(headers). Then defines a C code template strings: HEADER, BLOCK, CASE, FOOTER. Then defines folder = ROOT / \"aiohttp\". Then defines function gen_headers(headers) that writes a Python file with autogenerated comment, imports hdrs, defines tuple headers = (hdrs.xxx, ...). Returns StringIO.\n\nBut the code snippet is incomplete: missing definitions of calc_headers, build, etc. However we can infer overall functionality: It generates C code for fast header lookup (find_header) using a state machine (switch-case) based on characters of header strings. Also generates a Python module containing tuple of header constants.\n\nThus business logic: parse HTTP header definitions from aiohttp/hdrs.py, build a decision tree (dictionary) mapping characters to next states, generate C source code implementing find_header function that returns index of header or -1. Also generate Python file that imports hdrs and defines tuple of header constants.\n\nInputs: the root directory (current working directory), the hdrs definitions (via calc_headers). Outputs: generated C code (presumably written to a file) and generated Python code (StringIO). The script is run to update autogenerated files.\n\nLet's craft summary in Chinese with some English terms.\n\nNeed to start directly with summary content, no preamble. Provide business logic, inputs, outputs.\n\nLet's write:\n\n- \u8bfb\u53d6 aiohttp \u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 hdrs.py\uff0c\u63d0\u53d6\u6240\u6709 HTTP \u5934\u90e8\u540d\u79f0\u3002\n- \u4f7f\u7528 `build` \u5c06\u5934\u90e8\u5217\u8868\u6784\u5efa\u6210\u5b57\u7b26\u6811\uff08\u524d\u7f00\u6811\uff09\uff0c\u6bcf\u4e2a\u8282\u70b9\u5bf9\u5e94\u4e00\u4e2a\u5b57\u7b26\uff0c\u7ec8\u6b62\u8282\u70b9\u6807\u8bb0\u4e3a `TERMINAL`\u3002\n- \u6839\u636e\u5b57\u7b26\u6811\u751f\u6210 C \u8bed\u8a00\u51fd\u6570 `find_header(const char *str, int size)`\uff0c\u8be5\u51fd\u6570\u9010\u5b57\u7b26\u904d\u5386\u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u5229\u7528 `switch`/`case` \u7ed3\u6784\u5b9e\u73b0\u72b6\u6001\u673a\u67e5\u627e\uff0c\u8fd4\u56de\u5339\u914d\u5934\u90e8\u5728\u5217\u8868\u4e2d\u7684\u7d22\u5f15\uff0c\u672a\u5339\u914d\u8fd4\u56de -1\u3002\u751f\u6210\u7684\u4ee3\u7801\u7247\u6bb5\u7531 `HEADER\u3001BLOCK\u3001CASE\u3001FOOTER` \u7ec4\u5408\u800c\u6210\u3002\n- \u540c\u65f6\u751f\u6210\u4e00\u4e2a Python \u6a21\u5757\uff08\u901a\u8fc7 `gen_headers`\uff09\uff0c", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:33:09.397581"}