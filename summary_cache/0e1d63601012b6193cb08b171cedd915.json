{"summary": "We need to summarize functionality of code snippet. It's from aiohttp/web_response.py. It defines StreamResponse class and related functions. The snippet includes imports, constants, __all__, content coding mapping, slots, and a private async method _do_start_compression that sets up compression for response payload.\n\nWe need to summarize business logic, inputs, outputs. Provide Chinese description.\n\nLet's craft summary: The module provides HTTP response handling for aiohttp server. It defines ContentCoding enum (not shown) and StreamResponse class with attributes for status, headers, body, cookies, etc. The _do_start_compression method is called when response should be compressed; it receives a ContentCoding enum value, checks if not identity, then ensures payload writer exists, sets Content-Encoding header, enables compression on writer with given coding and strategy, and removes Content-Length header because compressed size may differ.\n\nOutputs: modifies internal state of response (headers, payload writer) and returns None (async). Business logic: manage HTTP response creation, compression, headers, cookies, etc.\n\nLet's produce final answer.assistantfinal\u63d0\u4f9b HTTP \u54cd\u5e94\u5bf9\u8c61\u7684\u5b9e\u73b0\uff0c\u4e3b\u8981\u7528\u4e8e aiohttp \u670d\u52a1\u5668\u7aef\u3002  \n\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\uff1a\n\n1. **\u6a21\u5757\u804c\u8d23**  \n   - \u8d1f\u8d23\u6784\u9020\u3001\u7ba1\u7406\u548c\u53d1\u9001 HTTP \u54cd\u5e94\uff0c\u5305\u62ec\u72b6\u6001\u7801\u3001\u539f\u56e0\u77ed\u8bed\u3001\u5934\u90e8\u3001\u6b63\u6587\u3001Cookie \u7b49\u3002  \n   - \u652f\u6301\u5bf9\u54cd\u5e94\u6b63\u6587\u8fdb\u884c **\u5185\u5bb9\u538b\u7f29**\uff08gzip/deflate \u7b49\uff09\uff0c\u5e76\u5728\u9700\u8981\u65f6\u81ea\u52a8\u8c03\u6574\u76f8\u5173\u5934\u90e8\u3002\n\n2. **\u5173\u952e\u8f93\u5165**  \n   - `coding: ContentCoding` \u2013 \u8868\u793a\u8981\u4f7f\u7528\u7684\u538b\u7f29\u65b9\u5f0f\uff08\u5982 `gzip`\u3001`deflate`\uff09\uff0c`ContentCoding.identity` \u8868\u793a\u4e0d\u538b\u7f29\u3002  \n   - \u54cd\u5e94\u5185\u90e8\u5c5e\u6027 `_payload_writer`\uff08`AbstractStreamWriter` \u5b9e\u4f8b\uff09\u5fc5\u987b\u5df2\u7ecf\u521b\u5efa\uff0c\u7528\u4e8e\u5b9e\u9645\u5199\u5165\u7f51\u7edc\u6d41\u3002  \n\n3. **\u5173\u952e\u8f93\u51fa / \u526f\u4f5c\u7528**  \n   - \u82e5 `coding` \u4e0d\u662f `identity`\uff0c\u5728\u54cd\u5e94\u5934\u90e8\u52a0\u5165 `Content-Encoding: <coding>`\u3002  \n   - \u8c03\u7528 `_payload_writer.enable_compression(coding.value, self._compression_strategy)`\uff0c\u8ba9\u5e95\u5c42\u5199\u5165\u5668\u5728\u53d1\u9001\u6570\u636e\u65f6\u81ea\u52a8\u8fdb\u884c\u76f8\u5e94\u7684\u538b\u7f29\u3002  \n   - \u5220\u9664\u5df2\u6709\u7684 `Content-Length` \u5934\u90e8\uff0c\u56e0\u4e3a\u538b\u7f29\u540e\u6b63\u6587\u957f\u5ea6\u4e0d\u53ef\u9884\u77e5\u3002  \n   - \u65b9\u6cd5\u672c\u8eab\u662f `async`\uff0c\u8fd4\u56de `None`\uff0c\u4f46\u901a\u8fc7\u4e0a\u8ff0\u526f\u4f5c\u7528\u5b8c\u6210", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:56:20.248356"}