{"summary": "The code snippet appears\r\nWe need to produce a summary of functionality of the code snippet. The snippet is from matchms/similarity/CosineGreedy.py. It imports repmat, absolute, reshape, zeros_like, where, power, argsort from numpy. It defines a function calc_intensities_product_within_tolerance(). Inside, it calls calc_mz_distance() and calc_intensities_product(). Then it computes within_tolerance = absolute(mz_distance) <= self.tolerance. Then returns where(within_tolerance, intensities_product, zeros_like(intensities_product)). So the function calculates product of intensities for peaks that are within a mass tolerance. It returns an array where for each pair of peaks, if the m/z distance is within tolerance, keep the product, else zero.\n\nWe need to summarize business logic, inputs, outputs. The function likely belongs to a class (self). It uses self.tolerance. It uses other methods calc_mz_distance and calc_intensities_product. So input: internal state of object (spectra). Output: array of intensities product masked by tolerance.\n\nWe need to start directly with summary content, no \"This code does\". Use Chinese. Provide business logic, inputs, outputs. Let's produce a concise summary.assistantfinal\u5b9e\u73b0\u5bf9\u4e24\u6761\u8d28\u8c31\u5728\u7ed9\u5b9a\u8d28\u91cf\u5bb9\u5dee\u5185\u7684\u5cf0\u5f3a\u5ea6\u4e58\u79ef\u8fdb\u884c\u7b5b\u9009\u3002  \n- **\u8f93\u5165**\uff1a\u4f9d\u8d56\u4e8e\u6240\u5728\u7c7b\u7684\u5185\u90e8\u72b6\u6001\uff08`self.tolerance`\uff09\u4ee5\u53ca\u7531\u540c\u7c7b\u7684 `calc_mz_distance()`\uff08\u8fd4\u56de\u4e24\u8c31\u5cf0\u7684 m/z \u5dee\u503c\u6570\u7ec4\uff09\u548c `calc_intensities_product()`\uff08\u8fd4\u56de\u5bf9\u5e94\u5cf0\u5f3a\u5ea6\u4e58\u79ef\u6570\u7ec4\uff09\u63d0\u4f9b\u7684\u6570\u636e\u3002  \n- **\u4e1a\u52a1\u903b\u8f91**\uff1a  \n  1. \u8ba1\u7b97\u6bcf\u5bf9\u5cf0\u7684 m/z \u5dee\u503c `mz_distance`\u3002  \n  2. \u8ba1\u7b97\u5bf9\u5e94\u7684\u5f3a\u5ea6\u4e58\u79ef `intensities_product`\u3002  \n  3. \u5224\u65ad\u6bcf\u4e2a\u5dee\u503c\u7684\u7edd\u5bf9\u503c\u662f\u5426\u4e0d\u8d85\u8fc7\u5bb9\u5dee `self.tolerance`\uff0c\u751f\u6210\u5e03\u5c14\u63a9\u7801 `within_tolerance`\u3002  \n  4. \u4f7f\u7528 `numpy.where` \u5c06\u6ee1\u8db3\u5bb9\u5dee\u7684\u4e58\u79ef\u4fdd\u7559\uff0c\u4e0d\u6ee1\u8db3\u7684\u7f6e\u4e3a 0\uff08\u4e0e `intensities_product` \u540c\u5f62\u7684\u96f6\u77e9\u9635\uff09\u3002  \n- **\u8f93\u51fa**\uff1a\u4e00\u4e2a\u4e0e `intensities_product` \u540c\u5f62\u7684\u6570\u7ec4\uff0c\u53ea\u6709\u5728 m/z \u5dee\u503c\u5728\u5bb9\u5dee", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:42:40.439580"}