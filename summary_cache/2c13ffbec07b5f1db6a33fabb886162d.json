{"summary": "- Function `reask_gemini_json` takes three parameters: `kwargs` (a dictionary of request arguments), `response` (the original response object from Gemini), and `exception` (the exception raised during validation.\n- It appends a new user\u2011type\u00a0\u200b\u00a0\u200b\u00a0\u00a0\u200b\u00a0\u00a0\u200b\u00a0\u200b\u00a0\u200b\u00a0\u00a0\u200b\u00a0\u200b\u00a0\u200b\u00a0... \nWe need to produce a summary of the functionality of the code. The code is from instructor/reask.py. It imports modules, defines type variables, and defines a function reask_gemini_json that modifies kwargs by appending a user message containing instructions to correct JSON based on errors. It returns the modified kwargs.\n\nWe need to start directly with the summary content, no preamble. Use Chinese (with English optionally). Focus on business logic, inputs, outputs.\n\nLet's produce a concise summary.assistantfinal- **\u529f\u80fd**\uff1a`reask_gemini_json` \u7528\u4e8e\u5728 Gemini\uff08\u5927\u8bed\u8a00\u6a21\u578b\uff09\u8fd4\u56de\u7684 JSON \u6570\u636e\u6821\u9a8c\u5931\u8d25\u540e\uff0c\u81ea\u52a8\u6784\u9020\u4e00\u6b21\u201c\u91cd\u65b0\u63d0\u95ee\u201d\uff08re\u2011ask\uff09\u8bf7\u6c42\uff0c\u4ee5\u8ba9\u6a21\u578b\u8fd4\u56de\u4fee\u6b63\u540e\u7684 JSON\u3002  \n- **\u8f93\u5165**  \n  1. `kwargs: dict[str, Any]` \u2013 \u539f\u59cb\u8bf7\u6c42\u53c2\u6570\u5b57\u5178\uff0c\u5fc5\u987b\u5305\u542b `contents` \u952e\uff08\u5217\u8868\uff09\uff0c\u7528\u4e8e\u5b58\u653e\u5bf9\u8bdd\u6d88\u606f\u3002  \n  2. `response: Any` \u2013 Gemini \u7684\u539f\u59cb\u54cd\u5e94\u5bf9\u8c61\uff0c\u4ee3\u7801\u4ec5\u4f7f\u7528 `response.text` \u8bfb\u53d6\u8fd4\u56de\u7684 JSON \u6587\u672c\u3002  \n  3. `exception: Exception` \u2013 \u5728 Pydantic \u6821\u9a8c\u6216\u5176\u4ed6\u89e3\u6790\u9636\u6bb5\u6355\u83b7\u7684\u5f02\u5e38\u5bf9\u8c61\uff0c\u7528\u4e8e\u5411\u6a21\u578b\u8bf4\u660e\u9519\u8bef\u7ec6\u8282\u3002  \n- **\u4e1a\u52a1\u903b\u8f91**  \n  1. \u5728 `kwargs[\"contents\"]`\uff08\u5bf9\u8bdd\u5386\u53f2\uff09\u672b\u5c3e\u8ffd\u52a0\u4e00\u6761 **user** \u89d2\u8272\u7684\u6d88\u606f\u3002  \n  2. \u8be5\u6d88\u606f\u7684\u5185\u5bb9\u4e3a\u56fa\u5b9a\u63d0\u793a\u8bed\uff0c\u5305\u542b\u4e24\u90e8\u5206\uff1a  \n     - \u201cCorrect the following JSON response, based on the errors given below:\u201d  \n     - \u539f\u59cb JSON \u6587\u672c (`response.text`)  \n     - \u6355\u83b7\u7684\u5f02\u5e38\u4fe1\u606f (`exception`)  \n  3. \u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u8ba9\u6a21\u578b\u5728\u4e0b\u4e00\u8f6e\u8c03\u7528\u65f6\u57fa\u4e8e\u9519\u8bef\u4fe1\u606f\u751f\u6210\u4fee\u6b63\u540e\u7684 JSON\u3002  \n- **\u8f93\u51fa**\uff1a\u8fd4\u56de\u4fee\u6539\u540e\u7684 `kwargs`\uff0c\u5176\u4e2d `contents` \u5df2\u52a0\u5165\u4e0a\u8ff0\u7ea0\u9519\u63d0\u793a\uff0c\u4f9b\u540e\u7eed\u8c03\u7528 Gemini API \u4f7f\u7528\u3002  \n\n**\u4e1a\u52a1\u573a\u666f**\uff1a", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:41:07.867159"}