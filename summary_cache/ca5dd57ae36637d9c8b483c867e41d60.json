{"summary": "- The function `handle_response_model` processes a response model and prepares arguments for an API call based on a specified mode.\n- Input parameters:\n  - `response_model`: a Pydantic model type or `None`.\n  - `mode`: an enum `Mode` indicating how to handle the response (default `Mode.TOOLS`).\n  - `**kwargs`: additional arguments for the API call, possibly containing messages.\n- The function copies the kwargs, extracts `autodetect_images` flag.\n- If `response_model` is `None`:\n  - Handles specific **Cohere** modes, returning `None` and possibly modified `kwargs.\n  - Converts **...**.\n```\"\n\nWe need to produce summary content directly, no preamble. Should be Chinese (maybe mix). Provide business logic, inputs, outputs. Let's craft concise summary.assistantfinal**\u529f\u80fd\u6982\u8ff0**  \n`handle_response_model` \u6839\u636e\u6307\u5b9a\u7684 `Mode` \u5bf9\u8fd4\u56de\u6a21\u578b\uff08Pydantic `BaseModel` \u7c7b\u578b\u6216 `None`\uff09\u8fdb\u884c\u7edf\u4e00\u5904\u7406\uff0c\u5e76\u751f\u6210\u9002\u914d\u540e\u7684 API \u8c03\u7528\u53c2\u6570\u3002\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u5305\u62ec\uff1a\n\n| \u6b65\u9aa4 | \u5173\u952e\u5904\u7406 | \u4e1a\u52a1\u610f\u4e49 |\n|------|----------|----------|\n| 1\ufe0f\u20e3 \u53c2\u6570\u51c6\u5907 | \u590d\u5236 `kwargs`\uff0c\u5f39\u51fa `autodetect_images`\uff08\u9ed8\u8ba4 `False`\uff09 | \u9632\u6b62\u539f\u59cb\u8c03\u7528\u53c2\u6570\u88ab\u610f\u5916\u4fee\u6539\uff0c\u7edf\u4e00\u56fe\u50cf\u81ea\u52a8\u68c0\u6d4b\u5f00\u5173 |\n| 2\ufe0f\u20e3 `response_model` \u4e3a `None` \u65f6 | - \u82e5 `mode` \u4e3a Cohere \u7cfb\u5217\uff08`COHERE_JSON_SCHEMA`\u3001`COHERE_TOOLS`\uff09\uff0c\u76f4\u63a5\u8d70 `handle_cohere_modes` <br>- \u82e5\u5b58\u5728 `messages`\uff0c\u8c03\u7528 `convert_messages` \u5c06\u6d88\u606f\u7edf\u4e00\u8f6c\u4e3a\u76ee\u6807\u6a21\u578b\u683c\u5f0f\uff1b<br>  - \u5bf9 Anthropic \u7cfb\u5217\uff08`ANTHROPIC_JSON`\u3001`ANTHROPIC_TOOLS`\uff09\u8fdb\u4e00\u6b65\u62bd\u53d6\u7cfb\u7edf\u6d88\u606f\u5e76\u653e\u5165 `system` \u5b57\u6bb5 | \u652f\u6301\u65e0\u7ed3\u6784\u5316\u8fd4\u56de\u7684\u573a\u666f\uff08\u5982\u4ec5\u9700\u8981\u8f6c\u53d1\u539f\u59cb\u6d88\u606f\uff09\uff0c\u5e76\u517c\u5bb9\u4e0d\u540c\u4f9b\u5e94\u5546\u7684\u6d88\u606f\u7ed3\u6784\u5dee\u5f02 |\n| 3\ufe0f\u20e3 `mode` \u4e3a `PARALLEL_TOOLS` \u65f6 | \u8c03\u7528 `handle_parallel_tools` \u8fdb\u884c\u5e76\u884c\u5de5\u5177\u8c03\u7528\u7684\u7279\u6b8a\u5305\u88c5 | \u9002\u914d\u5e76\u884c\u5de5\u5177\u6267\u884c\u7684\u8fd4\u56de\u683c\u5f0f |\n| 4\ufe0f\u20e3 \u7edf\u4e00\u5316 `response_model` | `prepare_response_model` \u5bf9\u6a21\u578b\u8fdb\u884c\u9884\u5904\u7406", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:44:59.128196"}