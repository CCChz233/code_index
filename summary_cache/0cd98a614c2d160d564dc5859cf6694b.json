{"summary": "The code defines a function `handle_cohere_tools` that processes a response model and a dictionary of keyword arguments. It first handles the cohere mode using `handle_cohere_modes` (which is not shown). Then it constructs an instruction text that includes a JSON schema for the model, and adds this instruction to the `chat_history` list. The function returns the modified `1`.\nWe need to produce a summary of the functionality of the code snippet. The snippet includes imports and a function handle_cohere_tools. The summary should focus on business logic, inputs, outputs. Use Chinese (with maybe English). No \"This code does...\" etc. Start directly with summary content.\n\nWe need to mention that the function takes a response model class (subclass of BaseModel) and a dict of kwargs, modifies kwargs by adding chat_history with instruction that includes JSON schema of the model, after handling cohere modes. Returns tuple of response model and updated kwargs.\n\nAlso mention that imports indicate usage of OpenAI, pydantic, instructor DSL, multimodal conversion, logging.\n\nProvide summary in Chinese.\n\nLet's craft.assistantfinal\u8be5\u6a21\u5757\u63d0\u4f9b\u4e86 `handle_cohere_tools` \u51fd\u6570\uff0c\u7528\u4e8e\u5728\u8c03\u7528 Cohere\uff08\u6216\u7c7b\u4f3c LLM\uff09\u65f6\u81ea\u52a8\u751f\u6210\u5e76\u6ce8\u5165\u6a21\u578b\u6821\u9a8c\u6307\u4ee4\u3002  \n\n**\u8f93\u5165**  \n- `response_model: type[T]`\uff1a\u7ee7\u627f\u81ea `pydantic.BaseModel` \u7684\u6a21\u578b\u7c7b\uff0c\u4ee3\u8868\u671f\u671b\u7684\u8fd4\u56de\u7ed3\u6784\u3002  \n- `new_kwargs: dict[str, Any]`\uff1a\u8c03\u7528 LLM \u65f6\u7684\u5173\u952e\u5b57\u53c2\u6570\u96c6\u5408\uff0c\u5fc5\u987b\u5305\u542b `chat_history`\uff08\u5217\u8868\uff09\uff0c\u7528\u4e8e\u5b58\u653e\u5bf9\u8bdd\u8bb0\u5f55\u3002  \n\n**\u4e1a\u52a1\u903b\u8f91**  \n1. \u8c03\u7528 `handle_cohere_modes`\uff08\u5916\u90e8\u5b9e\u73b0\uff09\u5bf9 `new_kwargs` \u8fdb\u884c\u6a21\u5f0f\u76f8\u5173\u7684\u9884\u5904\u7406\u3002  \n2. \u901a\u8fc7 `response_model.model_json_schema()` \u751f\u6210\u8be5\u6a21\u578b\u7684 JSON Schema\u3002  \n3. \u6784\u9020\u4e00\u6bb5\u7cfb\u7edf\u6307\u4ee4\uff0c\u8981\u6c42 LLM \u6839\u636e\u804a\u5929\u5386\u53f2\u548c\u63d0\u4f9b\u7684 JSON Schema **\u63d0\u53d6** \u4e00\u4e2a\u5408\u6cd5\u7684 JSON \u5bf9\u8c61\uff0c\u4f7f\u5176\u80fd\u591f\u88ab `response_model.model_validate_json()` \u6b63\u786e\u89e3\u6790\u3002  \n4. \u5c06\u8be5\u6307\u4ee4\u5305\u88c5\u4e3a `{\"role\": \"user\", \"message\": instruction}`\uff0c\u5e76 **\u7f6e\u4e8e** `chat_history` \u7684\u6700\u524d\u7aef\uff0c\u786e\u4fdd\u6a21\u578b\u5728\u751f\u6210\u7b54\u6848\u524d\u5148\u770b\u5230\u6b64\u7ea6\u675f\u3002  \n\n**\u8f93\u51fa**  \n- \u8fd4\u56de `(response_model, new_kwargs)`\uff0c\u5176\u4e2d `new", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:44:46.415672"}