{"summary": "We need to summarize functionality of the code snippet. The snippet is from aiohttp/client_ws.py, defines ClientWebSocketResponse class? Actually snippet includes imports and a function _send_heartbeat. The function sends heartbeat ping frames, schedules pong timeout, handles early heartbeat, uses loop time, calculates timeout, cancels previous pong response callback, sets new callback, sends ping frame via writer, creates task, handles Python version differences, registers callback for task completion.\n\nWe need to summarize business logic, inputs, outputs. The function _send_heartbeat has no parameters besides self; uses internal state: self._loop, self._heartbeat_when, self._conn, self._pong_heartbeat, self._cancel_pong_response_cb, self._pong_response_cb, self._writer, self._ping_task, self._ping_task_done. It returns None.\n\nSo summary: This method is part of WebSocket client handling; it ensures periodic heartbeat (ping) is sent according to schedule, reschedules if early, sets up timeout for pong response, sends ping frame asynchronously, and registers callback to handle ping task completion.\n\nNow produce Chinese summary. Must start directly with summary content, no preamble. Provide business logic, inputs, outputs. Use Chinese (maybe include English terms). Let's craft.\n\nassistantfinal\u5b9e\u73b0 WebSocket \u5ba2\u6237\u7aef\u5fc3\u8df3\u673a\u5236\u7684\u5185\u90e8\u65b9\u6cd5\u3002  \n- **\u8f93\u5165**\uff1a\u4f9d\u8d56\u5bf9\u8c61\u7684\u5185\u90e8\u72b6\u6001\uff0c\u5305\u62ec\u4e8b\u4ef6\u5faa\u73af `self._loop`\u3001\u4e0b\u6b21\u5fc3\u8df3\u65f6\u95f4 `self._heartbeat_when`\u3001\u8fde\u63a5\u5bf9\u8c61 `self._conn`\u3001\u5fc3\u8df3\u95f4\u9694 `self._pong_heartbeat`\u3001WebSocket \u5199\u5165\u5668 `self._writer` \u7b49\u3002\u65b9\u6cd5\u672c\u8eab\u4e0d\u63a5\u53d7\u5916\u90e8\u53c2\u6570\u3002  \n- **\u4e1a\u52a1\u903b\u8f91**\uff1a  \n  1. \u68c0\u67e5\u5f53\u524d\u65f6\u95f4\u662f\u5426\u5df2\u5230\u8fbe\u9884\u5b9a\u7684\u5fc3\u8df3\u53d1\u9001\u65f6\u523b\uff1b\u82e5\u8fc7\u65e9\u5219\u91cd\u65b0\u5728 `self._heartbeat_when` \u65f6\u523b\u8c03\u5ea6 `_send_heartbeat` \u5e76\u8fd4\u56de\u3002  \n  2. \u6839\u636e\u8fde\u63a5\u7684\u8d85\u65f6\u4e0a\u9650\uff08`_timeout_ceil_threshold`\uff09\u8ba1\u7b97\u4e0b\u4e00\u6b21\u671f\u5f85\u6536\u5230 pong \u7684\u8d85\u65f6\u65f6\u95f4 `when`\uff0c\u5e76\u4f7f\u7528 `loop.call_at` \u6ce8\u518c `_pong_not_received` \u56de\u8c03\uff0c\u4ee5\u5728\u8d85\u65f6\u672a\u6536\u5230 pong \u65f6\u89e6\u53d1\u9519\u8bef\u5904\u7406\u3002  \n  3. \u53d6\u6d88\u4e4b\u524d\u53ef\u80fd\u5df2\u6ce8\u518c\u7684 pong \u54cd\u5e94\u56de\u8c03 `self._cancel_pong_response_cb()`\uff0c\u5e76\u4fdd\u5b58\u65b0\u7684\u56de\u8c03\u53e5\u67c4 `self._pong_response_cb`", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:34:23.541920"}