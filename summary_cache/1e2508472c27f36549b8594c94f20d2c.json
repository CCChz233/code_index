{"summary": "The code defines a test case for testing ****.\nWe need to produce a summary in Chinese (or Chinese/English). The code is a pytest test that uses parameterization over models and modes. It creates an instructor client from Gemini, then calls chat.completions.create with response_model=Partial[UserExtract], streaming enabled, and context variables. It iterates over streamed partial results, asserts each is instance of UserExtract, and finally checks that the final model has correct fields.\n\nWe need to summarize functionality, business logic, inputs, outputs. No \"This code does...\" etc. Just start with summary content.\n\nLet's produce a concise Chinese summary. Mention that it's a test for streaming partial model extraction using Gemini LLM via instructor library. Input: model name, mode, template string with placeholders, context dict. Output: streamed UserExtract objects, final object with name and age.\n\nLet's write.assistantfinal\u5bf9 Gemini LLM \u7684 **streaming partial extraction** \u529f\u80fd\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\u3002  \n- **\u8f93\u5165**\uff1a  \n  1. `model`\uff08\u6a21\u578b\u6807\u8bc6\uff09\u548c `mode`\uff08\u8c03\u7528\u6a21\u5f0f\uff09\uff0c\u901a\u8fc7 `pytest.mark.parametrize` \u7ec4\u5408\u904d\u5386\u6240\u6709 `models` \u00d7 `modes`\u3002  \n  2. \u63d0\u793a\u6a21\u677f `{{ name }} is {{ age }} years old`\uff0c\u4ee5\u53ca\u4e0a\u4e0b\u6587 `{\"name\": \"Jason\", \"age\": 12}`\u3002  \n  3. `response_model=Partial[UserExtract]` \u6307\u5b9a\u8fd4\u56de\u7684\u90e8\u5206\u7ed3\u6784\u4f53\uff08`UserExtract` \u5305\u542b `name`\u3001`age` \u5b57\u6bb5\uff09\uff0c`stream=True` \u5f00\u542f\u6d41\u5f0f\u8f93\u51fa\uff0c`max_retries=2` \u8bbe\u5b9a\u91cd\u8bd5\u6b21\u6570\u3002  \n- **\u4e1a\u52a1\u903b\u8f91**\uff1a  \n  1. \u4f7f\u7528 `instructor.from_gemini` \u5305\u88c5 `genai.GenerativeModel`\uff0c\u521b\u5efa\u652f\u6301\u6307\u5b9a `mode` \u7684\u5ba2\u6237\u7aef\u3002  \n  2. \u8c03\u7528 `client.chat.completions.create` \u53d1\u9001\u5e26\u5360\u4f4d\u7b26\u7684\u6d88\u606f\u548c\u4e0a\u4e0b\u6587\uff0c\u671f\u671b\u6a21\u578b\u5728\u6d41\u5f0f\u8fd4\u56de\u65f6\u9010\u6b65\u586b\u5145 `UserExtract` \u7684\u5b57\u6bb5\u3002  \n  3. \u901a\u8fc7 `for m in model` \u8fed\u4ee3\u6bcf\u4e2a\u6d41\u5f0f\u7247\u6bb5\uff0c\u65ad\u8a00\u6bcf\u4e2a\u7247\u6bb5\u90fd\u662f `UserExtract` \u5b9e\u4f8b\uff0c\u5e76\u8bb0\u5f55\u6700\u540e\u4e00\u6b21\u8fd4\u56de\u7684\u5b8c\u6574\u5bf9\u8c61\u3002  \n  4. \u6700\u7ec8\u65ad\u8a00 `final_model.age == 12`\u3001`final_model.name == \"Jason\"`", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T21:02:33.797024"}