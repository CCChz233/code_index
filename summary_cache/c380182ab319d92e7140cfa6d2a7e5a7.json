{"summary": "The code defines a pytest fixture `generate_dataset` that creates synthetic synthetic.\nWe need to produce a summary in Chinese (or Chinese/English). The code is a pytest fixture that generates synthetic dataset using Modin pandas, writes to CSV in a kaggle directory, and cleans up after test. It defines constants DF_SIZE (1 GiB) and directory paths. The fixture yields a builder function that takes filename, columns, dtypes, size, files_to_remove. It validates column/dtype lengths, calculates row size using a small dataframe, determines number of rows needed to reach target size, creates dataframe, writes to CSV, records filenames for cleanup. After test, it removes generated files.\n\nWe need to focus on business logic, inputs, outputs. So we describe that the fixture is used in stress tests for Kaggle notebooks, generating large synthetic dataframes of specified schema and size, returning a Modin dataframe and persisting to CSV, cleaning up after.\n\nLet's produce final answer.assistantfinal\u751f\u6210\u5e76\u7ba1\u7406\u7528\u4e8e\u538b\u529b\u6d4b\u8bd5\u7684\u5408\u6210\u6570\u636e\u96c6\u3002  \n\n- **\u8f93\u5165**  \n  - `filename`\uff08\u76f8\u5bf9\u8def\u5f84\uff09  \n  - `columns`\uff08\u5217\u540d\u5217\u8868\uff09  \n  - `dtypes`\uff08\u5bf9\u5e94\u5217\u7684\u6570\u636e\u7c7b\u578b\u5217\u8868\uff09  \n  - `size`\uff08\u76ee\u6807\u6570\u636e\u91cf\uff0c\u9ed8\u8ba4 1\u202fGiB\uff09  \n  - `files_to_remove`\uff08\u5728\u751f\u6210\u8fc7\u7a0b\u4e2d\u9700\u8981\u989d\u5916\u5220\u9664\u7684\u4e34\u65f6\u6587\u4ef6\uff09  \n\n- **\u4e1a\u52a1\u903b\u8f91**  \n  1. \u9a8c\u8bc1 `columns` \u4e0e `dtypes` \u957f\u5ea6\u4e00\u81f4\u3002  \n  2. \u901a\u8fc7 `create_dataframe(columns, dtypes, 1)` \u751f\u6210\u4e00\u884c\u6837\u4f8b\uff0c\u8ba1\u7b97\u5355\u884c\u5360\u7528\u7684\u5185\u5b58 (`row_size`)\u3002  \n  3. \u6839\u636e\u76ee\u6807 `size` \u4e0e `row_size` \u8ba1\u7b97\u6240\u9700\u7684\u884c\u6570 `ceil(size / row_size)`\uff0c\u518d\u8c03\u7528 `create_dataframe` \u751f\u6210\u5b8c\u6574\u7684\u5408\u6210 `Modin` DataFrame\u3002  \n  4. \u5c06 DataFrame \u4fdd\u5b58\u4e3a CSV \u5230 `kaggle` \u5b50\u76ee\u5f55\u4e0b\u7684 `filename`\uff0c\u5e76\u8bb0\u5f55\u6240\u6709\u751f\u6210\u7684\u6587\u4ef6\u8def\u5f84\uff08\u5305\u62ec `files_to_remove` \u4e2d\u7684\u6587\u4ef6\uff09\u3002  \n  5. \u5c06\u751f\u6210\u7684 DataFrame \u4f5c\u4e3a\u8fd4\u56de\u503c\u4f9b\u6d4b\u8bd5\u4f7f\u7528\u3002  \n\n- **\u8f93\u51fa**  \n  - \u8fd4\u56de\u751f\u6210\u7684 `Modin` DataFrame\uff08\u53ef\u76f4\u63a5\u5728\u6d4b\u8bd5\u4e2d\u4f7f\u7528\uff09\u3002  \n  - \u5728\u78c1\u76d8\u4e0a\u4ea7\u751f\u5bf9\u5e94\u7684 CSV \u6587\u4ef6\uff08\u4ee5\u53ca `files", "prompt_id": "28ad819ea97a795ed2ae85e64d974c5c", "created_at": "2026-02-04T20:34:55.239586"}