{"summary": "A suite of pytest test classes that verify the functionality of head detection utilities in the transformer lens library. The tests construct token sequences, assess detection patterns for duplicate-token, induction, and previous-token heads, and validate numeric closeness helpers using absolute and scaled tolerances. They also check proper error handling for invalid patterns and head names.", "business_intent": "Ensure the head detection algorithms correctly identify specific attention patterns in transformer models and that related utility functions operate reliably, providing confidence in model analysis tools before production use.", "keywords": ["unit tests", "head detection", "transformer", "duplicate token", "induction head", "previous token head", "numeric tolerance", "pattern detection", "pytest", "torch"], "summary_hash": "33a244b2acaa", "cached_at": "2026-02-08T13:22:36+00:00"}