{"summary": "Represents segment identifiers for query and key/value token streams, enabling construction of a segment‑based attention mask that is combined with static masks (e.g., causal) to restrict attention to tokens belonging to the same segment and to guarantee non‑zero rows for a valid softmax.", "business_intent": "Facilitate safe and correct segment‑aware attention in transformer models by providing per‑token segment ids and utilities to generate masks that prevent cross‑segment attention and avoid invalid softmax calculations.", "keywords": ["segment ids", "attention mask", "transformer", "query sequence", "key/value sequence", "cross-segment attention", "softmax stability", "causal masking"], "summary_hash": "d4e8b7cc570e", "cached_at": "2026-02-09T11:49:32+00:00"}